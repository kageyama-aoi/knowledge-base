<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>[Local Stack] Guide: Docker + PHP + MySQL ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <style>
    :root{
      --bg:#f1f5f9; --fg:#1e293b; --muted:#64748b; --line:#e2e8f0;
      --pri:#2563eb; --ok:#16a34a; --warn:#b45309; --err:#b91c1c;
      --sidebar-bg:#ffffff; --sidebar-width:280px; --header-height:60px;
    }
    html[data-theme="dark"]{
      --bg: #0f172a;            /* ãƒ¡ã‚¤ãƒ³èƒŒæ™¯: æš—ã„ã‚°ãƒ¬ãƒ¼ */
      --fg: #d1d5db;            /* æ–‡å­—: æ˜ã‚‹ã„ã‚°ãƒ¬ãƒ¼ */
      --muted: #9ca3af;         /* è£œåŠ©æ–‡å­— */
      --line: #374151;          /* ç½«ç·š */
      --pri: #60a5fa;           /* ãƒ—ãƒ©ã‚¤ãƒãƒª */
      --ok: #34d399;            /* OK */
      --warn: #f59e0b;          /* è­¦å‘Š */
      --err: #f87171;           /* ã‚¨ãƒ©ãƒ¼ */
      --sidebar-bg: #1f293b;    /* ã‚µã‚¤ãƒ‰ãƒãƒ¼èƒŒæ™¯: ãƒ¡ã‚¤ãƒ³ã‚ˆã‚Šå°‘ã—æ˜ã‚‹ã„ */
    }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; line-height:1.7; margin:0; color:var(--fg); background:var(--bg); transition: background-color .2s, color .2s;}
    header{height:var(--header-height); background:var(--sidebar-bg); border-bottom:1px solid var(--line); display:flex; align-items:center; padding:0 1rem; position:sticky; top:0; z-index:10;}
    .brand{display:flex; align-items:center; gap:.8rem; flex:1; min-width:0;}
    .sidebar-toggle{background:transparent; border:1px solid var(--line); border-radius:8px; padding:.4rem .6rem; cursor:pointer; display:inline-flex; align-items:center; gap:.5rem; font-size:.9rem;}
    .sidebar-toggle-icon{font-size:1.2em; line-height:1; width:1.2em; text-align:center; font-weight:bold;}
    h1{font-size:clamp(1.1rem, 2.5vw, 1.3rem); margin:0; flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}

    .theme-toggle{ margin-left: auto; }
    .switch{display:inline-flex; align-items:center; gap:.5rem; padding:.2rem; border:1px solid var(--line); border-radius:999px; background:var(--bg);}
    .switch span{font-size:.9rem; line-height:1; padding:0 .2rem;}
    .switch input{appearance:none; width:38px; height:20px; border-radius:999px; background:var(--muted); position:relative; outline:none; cursor:pointer; transition: background-color .2s;}
    .switch input:checked{background:var(--pri)}
    .switch input:after{content:""; position:absolute; width:16px; height:16px; background:var(--sidebar-bg); border-radius:50%; top:2px; left:2px; transition:all .2s ease-in-out;}
    .switch input:checked:after{transform:translateX(18px);}

    .layout{display:grid; grid-template-columns:var(--sidebar-width) 1fr; transition:grid-template-columns .2s ease;}
    .layout.sidebar-collapsed{grid-template-columns:0 1fr;}

    nav.sidebar{background:var(--sidebar-bg); border-right:1px solid var(--line); padding:1rem; overflow:auto; height:calc(100vh - var(--header-height)); position:sticky; top:var(--header-height); transition:padding .2s ease, opacity .2s ease; white-space:nowrap;}
    .layout.sidebar-collapsed nav.sidebar{padding-left:0; padding-right:0; opacity:0; overflow-x:hidden;}
    .toc-title{font-weight:700; font-size:1rem; margin:.2rem 0 .8rem;}
    .toc ol{list-style:none; padding:0; margin:0;}
    .toc li a{display:block; padding:.4rem .6rem; border-radius:6px; text-decoration:none; color:var(--muted); font-size:.9rem; border-left:3px solid transparent; transition: background-color .2s, color .2s;}
    .toc li a:hover{background:color-mix(in oklab, var(--line) 40%, transparent);}
    .toc li a.active{font-weight:600; color:var(--pri); border-left-color:var(--pri); background:color-mix(in oklab, var(--pri) 15%, transparent);}

    main{padding:1.5rem 2rem; max-width:960px;}
    h2{font-size:1.8rem; margin:2.5rem 0 1rem; border-bottom:1px solid var(--line); padding-bottom:.5rem; scroll-margin-top: calc(var(--header-height) + 1rem);}
    h3{font-size:1.25rem; margin:1.5rem 0 .6rem;}
    p,li{font-size:1rem;}
    a{color:var(--pri);} a:hover{text-decoration:none;}
    hr{border:none; border-top:1px solid var(--line); margin:2rem 0;}

    code{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size:.9em; background:color-mix(in oklab, var(--fg) 8%, transparent); padding:.2em .4em; border-radius:4px;}
    /* pre ã®èƒŒæ™¯ã¯ highlight.js ã®ãƒ†ãƒ¼ãƒã«åˆã‚ã›ã€padding ã¯ä¸­ã® code ã‚¿ã‚°ã«ä»»ã›ã‚‹ */
    pre{background:#282c34; border-radius:10px; overflow:auto; max-height:400px;}
    pre code{background:transparent; padding:0; border-radius:0;}
    /* highlight.js ãŒé©ç”¨ã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®paddingã‚’æ˜ç¤º */
    pre code.hljs { padding: 1em; }

    .code-block{position:relative;margin:1em 0}
    /* Mermaid.js ç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .mermaid {
      background-color: var(--sidebar-bg); border-radius: 10px; padding: 1rem; text-align: center;
      transition: background-color .2s;
    }
    /* Mermaidã®ãƒ†ãƒ¼ãƒã‚’CSSå¤‰æ•°ã§ä¸Šæ›¸ã */
    .mermaid .node { fill: var(--bg); stroke: var(--pri); stroke-width: 2px; }
    .mermaid .node .nodeLabel { color: var(--fg); }
    .mermaid .container { fill: var(--sidebar-bg); stroke: var(--line); }
    .mermaid .container .nodeLabel { color: var(--fg); }
    .mermaid .file { fill: var(--bg); stroke: var(--line); stroke-dasharray: 5 5; }
    .mermaid .file .nodeLabel { color: var(--muted); }
    .mermaid .volume { fill: var(--bg); stroke: var(--line); stroke-dasharray: 2 2; }
    .mermaid .volume .nodeLabel { color: var(--muted); }
    /* çŸ¢å°ã®ãƒ†ã‚­ã‚¹ãƒˆèƒŒæ™¯ */
    .mermaid .edgeLabel {
      background-color: var(--sidebar-bg) !important;
      color: var(--fg);
    }
    .code-block pre{margin:0}
    .copy-btn{
      position:absolute; top:.5rem; right:.5rem; z-index:1;
      background:var(--sidebar-bg); border:1px solid var(--line); color:var(--muted);
      border-radius:6px; padding:.2rem .5rem; cursor:pointer; font-size:.8rem;
      transition:all .2s ease;
    }
    .copy-btn:hover{background:var(--pri); color:var(--sidebar-bg);}
    .copy-btn.copied{background:var(--ok); color:var(--sidebar-bg); border-color:var(--ok);}

    .note, .good, .warn, .bad{padding:.8rem 1rem; border-radius:8px; margin:1em 0; border-left:4px solid; background: var(--bg-soft, transparent);}
    .note{border-color:var(--pri); background-color: color-mix(in oklab, var(--pri) 15%, transparent);}
    .good{border-color:var(--ok); background-color: color-mix(in oklab, var(--ok) 15%, transparent);}
    .warn{border-color:var(--warn); background-color: color-mix(in oklab, var(--warn) 15%, transparent);}
    .bad{border-color:var(--err); background-color: color-mix(in oklab, var(--err) 15%, transparent);}

    .grid{display:grid; gap:1rem;}
    .two{grid-template-columns:repeat(auto-fit,minmax(280px,1fr));}
    .kbd{display:inline-block; padding:.2em .5em; border:1px solid var(--line); border-bottom-width:2px; border-radius:6px; background:color-mix(in oklab, var(--line) 50%, var(--bg)); font-size:.9em;}
    table{border-collapse:collapse; width:100%; margin:1em 0; font-size:.95rem;}
    th,td{border:1px solid var(--line); padding:.6rem .8rem; vertical-align:top;}
    th{background:color-mix(in oklab, var(--line) 30%, var(--sidebar-bg)); text-align:left; font-weight:600;}
    .small{font-size:.9em; color:var(--muted);}

    @media (max-width: 900px){
      .layout{grid-template-columns:1fr;}
      .layout.sidebar-collapsed{grid-template-columns:1fr;}
      nav.sidebar{position:fixed; inset:var(--header-height) 0 auto 0; height:calc(100vh - var(--header-height)); transform:translateX(-100%); transition:transform .2s ease; z-index:20;}
      nav.sidebar.open{transform:translateX(0);}
      main{padding:1rem;}
      h2{font-size:1.5rem;}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <button class="sidebar-toggle" aria-controls="sidebar" aria-label="ç›®æ¬¡ã®é–‹é–‰">
        <span class="sidebar-toggle-icon"></span> ç›®æ¬¡
      </button>
      <h1>Docker + PHP + MySQL ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã‚¬ã‚¤ãƒ‰</h1>
    </div>
    <div class="theme-toggle">
      <label class="switch" title="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ">
        <span>â˜€ï¸</span>
        <input id="themeSwitch" type="checkbox"/>
        <span>ğŸŒ™</span>
      </label>
    </div>
  </header>

  <div class="layout">
    <nav id="sidebar" class="sidebar">
      <div class="toc">
        <div class="toc-title">ç›®æ¬¡</div>
        <ol>
          <li><a href="#structure">1. ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆ</a></li>
          <li><a href="#why-structure">2. ã“ã®æ§‹æˆã®åˆ©ç‚¹</a></li>
          <li><a href="#architecture">3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆå›³</a></li>
          <li><a href="#env">4. .envï¼ˆç’°å¢ƒå¤‰æ•°ï¼‰</a></li>
          <li><a href="#compose">5. docker-compose.ymlï¼ˆè¨­è¨ˆå›³ï¼‰</a></li>
          <li><a href="#discovery">6. ã‚³ãƒ©ãƒ ï¼šã‚³ãƒ³ãƒ†ãƒŠé–“ã®DBæ¥ç¶šã®ä»•çµ„ã¿</a></li>
          <li><a href="#dockerfile">7. web/Dockerfileï¼ˆPHPç’°å¢ƒï¼‰</a></li>
          <li><a href="#phpmyadmin-config">8. phpmyadmin/config.inc.phpï¼ˆè¨­å®šï¼‰</a></li>
          <li><a href="#phpini">9. web/php.iniï¼ˆPHPè¨­å®šï¼‰</a></li>
          <li><a href="#sql">10. db/init/001_init.sqlï¼ˆåˆæœŸãƒ‡ãƒ¼ã‚¿ï¼‰</a></li>
          <li><a href="#indexphp">11. public/index.phpï¼ˆCRUDã‚¢ãƒ—ãƒªï¼‰</a></li>
          <li><a href="#run">12. èµ·å‹•ãƒ»ç¢ºèªãƒ»åœæ­¢ã®æ‰‹é †</a></li>
          <li><a href="#trouble">13. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</a></li>
          <li><a href="#concepts">14. ç”¨èªé›†</a></li>
          <li><a href="#next">15. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</a></li>
        </ol>
      </div>
    </nav>

    <main>
      <p class="small">ç›®çš„ï¼šãƒ­ãƒ¼ã‚«ãƒ«ã§æœ€å°æ§‹æˆã® Webã‚¢ãƒ—ãƒªï¼ˆPHPï¼‰ã‚’Dockerã§ç«‹ã¡ä¸Šã’ã€MySQL ã¨æ¥ç¶šã—ã¦ CRUDï¼ˆè¿½åŠ ãƒ»ç·¨é›†ãƒ»å‰Šé™¤ï¼‰ã¾ã§ç¢ºèªã™ã‚‹ã€‚</p>

      <h2 id="structure">1. ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆ</h2>
      <div class="code-block">
        <button type="button" class="copy-btn" title="ã‚³ãƒ”ãƒ¼">ğŸ“‹</button>
        <pre><code class="language-plaintext">my-local-stack/
â”œâ”€ docker-compose.yml
â”œâ”€ .env
â”œâ”€ db/
â”‚  â””â”€ init/
â”‚     â””â”€ 001_init.sql
â”œâ”€ web/
â”‚  â”œâ”€ Dockerfile
â”‚  â””â”€ php.ini
â”œâ”€ phpmyadmin/
â”‚  â””â”€ config.inc.php
â””â”€ public/
   â””â”€ index.php</code></pre>
      </div>

      <h2 id="why-structure">2. ã“ã®æ§‹æˆã®åˆ©ç‚¹</h2>
      <ul>
        <li><strong>å½¹å‰²åˆ†é›¢ï¼š</strong> è¨­è¨ˆå›³ï¼ˆcomposeï¼‰ãƒ»ç’°å¢ƒå·®åˆ†ï¼ˆ.envï¼‰ãƒ»DBåˆæœŸåŒ–ï¼ˆdb/initï¼‰ãƒ»ã‚¢ãƒ—ãƒªï¼ˆpublicï¼‰ãƒ»è¨€èªè¨­å®šï¼ˆwebï¼‰ã‚’åˆ†ã‘ã¦è¿·å­ã‚’é˜²ãã€‚</li>
        <li><strong>å†ç¾æ€§ï¼š</strong> <kbd class="kbd">docker compose up -d</kbd> ã§èª°ã®PCã§ã‚‚åŒã˜çŠ¶æ…‹ãŒèµ·å‹•ã€‚</li>
        <li><strong>å®‰å…¨æ€§ï¼š</strong> å…¬é–‹ç¯„å›²ï¼ˆpublic/ï¼‰ã¨éå…¬é–‹è¨­å®šï¼ˆ.env, php.ini ç­‰ï¼‰ã‚’åˆ†é›¢ã€‚</li>
      </ul>
      <div class="good"><strong>ãƒã‚¤ãƒ³ãƒˆï¼š</strong> å¾Œã§ãƒ†ã‚¹ãƒˆã‚„ãƒ­ã‚°ã‚’è¿½åŠ ã—ã¦ã‚‚å´©ã‚Œã«ãã„ã€Œå™¨ã€ã«ãªã£ã¦ã„ã¾ã™ã€‚</div>

      <h2 id="architecture">3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆå›³</h2>
      <pre class="mermaid">
        graph TD
            subgraph "ãƒ¦ãƒ¼ã‚¶ãƒ¼PC (localhost)"
                A["ãƒ–ãƒ©ã‚¦ã‚¶"]:::node
            end

            subgraph "Dockerå†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯"
                B["web (Apache/PHP)"]:::container
                C["phpmyadmin"]:::container
                D["db (MySQL)"]:::container
            end

            subgraph "ãƒ›ã‚¹ãƒˆPCã®ãƒ•ã‚¡ã‚¤ãƒ« / Volume"
                F1["public/"]:::file
                F2["web/php.ini"]:::file
                F3["db/init/"]:::file
                F4["phpmyadmin/config.inc.php"]:::file
                V1["db_data (Volume)"]:::volume
            end

            A -- ":${WEB_PORT}" --> B
            A -- ":${PHPMYADMIN_PORT}" --> C
            B -- "TCPæ¥ç¶š (ãƒ›ã‚¹ãƒˆå: db)" --> D
            C -- "TCPæ¥ç¶š (ãƒ›ã‚¹ãƒˆå: db)" --> D

            B -.-> F1
            B -.-> F2
            D -.-> F3
            C -.-> F4
            D -.-> V1
      </pre>
      <div class="note">ã“ã®å›³ã¯ã€å„ã‚³ãƒ³ãƒ†ãƒŠãŒã©ã®ã‚ˆã†ã«é€£æºã—ã€ãƒ›ã‚¹ãƒˆPCä¸Šã®ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒæœŸã—ã¦ã„ã‚‹ã‹ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚çŸ¢å°ã¯ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œã‚„ä¾å­˜é–¢ä¿‚ã‚’è¡¨ã—ã¾ã™ã€‚<code>${...}</code> ã¯ <code>.env</code> ãƒ•ã‚¡ã‚¤ãƒ«ã®å€¤ã«ç½®ãæ›ãˆã‚‰ã‚Œã¾ã™ã€‚</div>

      <h2 id="env">4. <code>.env</code>ï¼ˆç’°å¢ƒå¤‰æ•°ï¼‰</h2>
      <p>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚„ãƒãƒ¼ãƒˆãªã©ã€äººã‚„ç’°å¢ƒã«ã‚ˆã£ã¦å¤‰ãˆãŸã„å€¤ã‚’ä¸€ã‹æ‰€ã«é›†ç´„ã—ã¾ã™ã€‚</p>
      <div class="code-block">
        <button type="button" class="copy-btn" title="ã‚³ãƒ”ãƒ¼">ğŸ“‹</button>
        <pre><code class="language-ini">MYSQL_DATABASE=myapp
MYSQL_USER=myuser
MYSQL_PASSWORD=mypassword
MYSQL_ROOT_PASSWORD=rootpassword

WEB_PORT=8080
PHPMYADMIN_PORT=8081
DB_PORT=3306
      </code></pre>
      </div>
      <div class="note">compose ã‹ã‚‰ <code>${å¤‰æ•°å}</code> ã§å‚ç…§ã•ã‚Œã¾ã™ã€‚Git ã«ã¯åŸºæœ¬çš„ã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„æƒ³å®šï¼ˆ<code>.gitignore</code>ï¼‰</div>

      <h2 id="compose">5. <code>docker-compose.yml</code>ï¼ˆè¨­è¨ˆå›³ï¼‰</h2>
      <div class="code-block">
        <button type="button" class="copy-btn" title="ã‚³ãƒ”ãƒ¼">ğŸ“‹</button>
        <pre><code class="language-yaml">services:
  db:
    image: mysql:8.4
    environment:
      MYSQL_DATABASE: ${MYSQL_DATABASE}
      MYSQL_USER: ${MYSQL_USER}
      MYSQL_PASSWORD: ${MYSQL_PASSWORD}
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      TZ: Asia/Tokyo
    command: ["mysqld","--character-set-server=utf8mb4","--collation-server=utf8mb4_0900_ai_ci"]
    ports:
      - "${DB_PORT}:3306"
    volumes:
      - db_data:/var/lib/mysql
      - ./db/init:/docker-entrypoint-initdb.d:ro
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-hdb", "-p${MYSQL_ROOT_PASSWORD}"]
      interval: 5s
      timeout: 3s
      retries: 20

  phpmyadmin:
    image: phpmyadmin:latest
    depends_on:
      db:
        condition: service_healthy
    environment:
      PMA_HOST: db
      UPLOAD_LIMIT: 64M
    ports:
      - "${PHPMYADMIN_PORT}:80"
    volumes:
      - ./phpmyadmin/config.inc.php:/etc/phpmyadmin/config.inc.php:ro
    # Windowsç’°å¢ƒã§ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼å¯¾ç­–
    command: >
      sh -c "
        echo '==> Changing permissions for config.inc.php...';
        chmod 644 /etc/phpmyadmin/config.inc.php;
        echo '==> Permissions after chmod:';
        ls -l /etc/phpmyadmin/config.inc.php;
        echo '==> Starting phpMyAdmin...';
        /docker-entrypoint.sh apache2-foreground
      "

  web:
    build:
      context: ./web
      dockerfile: Dockerfile
    depends_on:
      db:
        condition: service_healthy
    volumes:
      - ./public:/var/www/html
      - ./web/php.ini:/usr/local/etc/php/php.ini:ro
    environment:
      DB_HOST: db
      DB_NAME: ${MYSQL_DATABASE}
      DB_USER: ${MYSQL_USER}
      DB_PASS: ${MYSQL_PASSWORD}
      TZ: Asia/Tokyo
    ports:
      - "${WEB_PORT}:80"

volumes:
  db_data: {}
      </code></pre>
      </div>
      <ul>
        <li><strong>dbï¼š</strong> åˆå›èµ·å‹•æ™‚ã« <code>db/init</code> ã®SQLãŒè‡ªå‹•å®Ÿè¡Œã€‚</li>
        <li><strong>phpmyadminï¼š</strong> GUIã§DBç¢ºèªã€‚</li>
        <li><strong>webï¼š</strong> PHP + Apacheã€‚<code>public/</code> ã‚’ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ«ãƒ¼ãƒˆã«ãƒã‚¦ãƒ³ãƒˆã€‚</li>
        <li><strong>depends_on + healthcheckï¼š</strong> DBãŒæº–å‚™å®Œäº†å¾Œã«ä»–ãŒèµ·å‹• â†’ å®‰å®šã€‚</li>
      </ul>

      <h2 id="discovery">6. ã‚³ãƒ©ãƒ ï¼šã‚³ãƒ³ãƒ†ãƒŠé–“ã®DBæ¥ç¶šã®ä»•çµ„ã¿</h2>
      <p>ãªãœ<code>web</code>ã‚³ãƒ³ãƒ†ãƒŠã¯ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’çŸ¥ã‚‰ãªã„ã®ã«<code>db</code>ã¨ã„ã†åå‰ã ã‘ã§MySQLã«æ¥ç¶šã§ãã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ<br>
      ã“ã‚Œã¯ã€Docker ComposeãŒæä¾›ã™ã‚‹ã€Œ<strong>ä»®æƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</strong>ã€ã¨ã€Œ<strong>ã‚µãƒ¼ãƒ“ã‚¹ãƒ‡ã‚£ã‚¹ã‚«ãƒãƒª</strong>ã€ã¨ã„ã†2ã¤ã®å¼·åŠ›ãªæ©Ÿèƒ½ã®ãŠã‹ã’ã§ã™ã€‚</p>
      <ol>
        <li>
          <strong>å°‚ç”¨ã®ä»®æƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒä½œã‚‰ã‚Œã‚‹</strong><br>
          <code>docker compose up</code>ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€Composeãƒ•ã‚¡ã‚¤ãƒ«ã«å®šç¾©ã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ï¼ˆ<code>web</code>, <code>db</code>ãªã©ï¼‰ã ã‘ãŒå‚åŠ ã§ãã‚‹ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒè‡ªå‹•ã§ä½œæˆã•ã‚Œã¾ã™ã€‚ã“ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã§ã¯ã€å„ã‚³ãƒ³ãƒ†ãƒŠã¯äº’ã„ã«<strong>TCP/IPé€šä¿¡</strong>ãŒå¯èƒ½ã§ã™ã€‚
        </li>
        <li>
          <strong>ã‚µãƒ¼ãƒ“ã‚¹åãŒãƒ›ã‚¹ãƒˆåã¨ã—ã¦ä½¿ãˆã‚‹ï¼ˆã‚µãƒ¼ãƒ“ã‚¹ãƒ‡ã‚£ã‚¹ã‚«ãƒãƒªï¼‰</strong><br>
          ã“ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ã¯Dockerå†…è”µã®DNSã‚µãƒ¼ãƒãƒ¼ãŒå­˜åœ¨ã—ã¾ã™ã€‚<code>web</code>ã‚³ãƒ³ãƒ†ãƒŠãŒã€Œ<code>db</code>ã€ã¨ã„ã†ãƒ›ã‚¹ãƒˆåã§é€šä¿¡ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ã“ã®DNSãŒè‡ªå‹•çš„ã«<code>db</code>ã‚³ãƒ³ãƒ†ãƒŠã®å†…éƒ¨IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›ï¼ˆåå‰è§£æ±ºï¼‰ã—ã¦ãã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç§ãŸã¡ã¯IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ„è­˜ã™ã‚‹ã“ã¨ãªãã€ã‚µãƒ¼ãƒ“ã‚¹åã§é€šä¿¡å…ˆã‚’æŒ‡å®šã§ãã¾ã™ã€‚
        </li>
        <li>
          <strong>ã‚³ãƒ³ãƒ†ãƒŠé–“ã®ç›´æ¥é€šä¿¡</strong><br>
          PHPã‚³ãƒ¼ãƒ‰ï¼ˆ<code>new PDO("mysql:host=db;...")</code>ï¼‰ã¯ã€ã€Œ<code>db</code>ã¨ã„ã†ãƒ›ã‚¹ãƒˆã®3306ç•ªãƒãƒ¼ãƒˆï¼ˆMySQLã®æ¨™æº–ãƒãƒ¼ãƒˆï¼‰ã«TCPã§æ¥ç¶šã›ã‚ˆã€ã¨ã„ã†æŒ‡ç¤ºã‚’å‡ºã—ã¾ã™ã€‚ã“ã‚Œã¯Dockerãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã§å®Œçµã™ã‚‹ç›´æ¥çš„ãªé€šä¿¡ã§ã™ã€‚
        </li>
      </ol>
      <div class="good"><strong>çµè«–ï¼š</strong>DockerãŒè£å´ã§ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã¨åå‰è§£æ±ºã‚’è‡ªå‹•ã§è¡Œã£ã¦ãã‚Œã‚‹ãŸã‚ã€ç§ãŸã¡ã¯ã‚µãƒ¼ãƒ“ã‚¹åã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§ã€ç°¡å˜ã‹ã¤å®‰å…¨ã«ã‚³ãƒ³ãƒ†ãƒŠé–“ã‚’æ¥ç¶šã§ãã¾ã™ã€‚</div>
      <div class="note"><strong>è£œè¶³ï¼š</strong><code>docker-compose.yml</code>ã®<code>ports</code>è¨­å®šï¼ˆä¾‹: <code>"8080:80"</code>ï¼‰ã¯ã€ãƒ›ã‚¹ãƒˆPCï¼ˆå¤–éƒ¨ï¼‰ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠã¸ã®é€šä¿¡ã‚’ä¸­ç¶™ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠåŒå£«ã®å†…éƒ¨é€šä¿¡ã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“ã€‚</div>

      <h2 id="dockerfile">7. <code>web/Dockerfile</code>ï¼ˆPHPç’°å¢ƒï¼‰</h2>
      <div class="code-block">
        <button type="button" class="copy-btn" title="ã‚³ãƒ”ãƒ¼">ğŸ“‹</button>
        <pre><code class="language-dockerfile">FROM php:8.2-apache

RUN docker-php-ext-install pdo pdo_mysql
RUN echo "ServerName localhost" &gt;&gt; /etc/apache2/apache2.conf \
    &amp;&amp; a2enmod rewrite

WORKDIR /var/www/html
      </code></pre>
      </div>
      <div class="note"><strong>ç†ç”±ï¼š</strong> MySQLæ¥ç¶šã«ã¯ <code>pdo_mysql</code> ãŒå¿…é ˆã€‚å°†æ¥ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã« <code>mod_rewrite</code> ãŒä¾¿åˆ©ã€‚</div>

      <h2 id="phpmyadmin-config">8. <code>phpmyadmin/config.inc.php</code>ï¼ˆè¨­å®šï¼‰</h2>
      <p>phpMyAdminã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’é«˜ã‚ã€DBã‚³ãƒ³ãƒ†ãƒŠã¨ã®é€šä¿¡ã‚’æš—å·åŒ–ï¼ˆSSLåŒ–ï¼‰ã™ã‚‹ãŸã‚ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚</p>
      <div class="code-block">
        <button type="button" class="copy-btn" title="ã‚³ãƒ”ãƒ¼">ğŸ“‹</button>
        <pre><code class="language-php">&lt;?php
declare(strict_types=1);

// ã‚¯ãƒƒã‚­ãƒ¼èªè¨¼ã®æš—å·åŒ–ã‚­ãƒ¼ã€‚32æ–‡å­—ä»¥ä¸Šã®ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ã‚’è¨­å®šã—ã¾ã™ã€‚
$cfg['blowfish_secret'] = 'a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6';

$i = 1;
$cfg['Servers'][$i]['host'] = 'db';
$cfg['Servers'][$i]['compress'] = false;
$cfg['Servers'][$i]['AllowNoPassword'] = false;

// DBã‚³ãƒ³ãƒ†ãƒŠã¨ã®é€šä¿¡ã‚’SSLåŒ–
$cfg['Servers'][$i]['ssl'] = true;
$cfg['Servers'][$i]['ssl_verify'] = false; // ãƒ­ãƒ¼ã‚«ãƒ«ãªã®ã§è¨¼æ˜æ›¸æ¤œè¨¼ã¯ç„¡åŠ¹
      </code></pre>
      </div>
      <div class="note">ã“ã®è¨­å®šã«ã‚ˆã‚Šã€phpMyAdminã®ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã§ã€ŒSSLã¯ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€ã¨ã„ã†è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œãªããªã‚Šã¾ã™ã€‚</div>

      <h2 id="phpini">9. <code>web/php.ini</code>ï¼ˆPHPè¨­å®šï¼‰</h2>
      <div class="code-block">
        <button type="button" class="copy-btn" title="ã‚³ãƒ”ãƒ¼">ğŸ“‹</button>
        <pre><code class="language-ini">display_errors=On
error_reporting=E_ALL
date.timezone=Asia/Tokyo
upload_max_filesize=32M
post_max_size=32M
memory_limit=256M
      </code></pre>
      </div>
      <div class="warn"><strong>æ³¨æ„ï¼š</strong> æœ¬ç•ªã§ã¯ <code>display_errors=Off</code> ãŒåŸºæœ¬ã€‚é–‹ç™ºã§ã¯ã‚¨ãƒ©ãƒ¼è¦‹ãˆã‚‹åŒ–ãŒå­¦ç¿’åŠ¹ç‡â†‘</div>

      <h2 id="sql">10. <code>db/init/001_init.sql</code>ï¼ˆåˆæœŸãƒ‡ãƒ¼ã‚¿ï¼‰</h2>
      <div class="code-block">
        <button type="button" class="copy-btn" title="ã‚³ãƒ”ãƒ¼">ğŸ“‹</button>
        <pre><code class="language-sql">CREATE TABLE IF NOT EXISTS items (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  price INT NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO items (name, price) VALUES
  ('Apple', 120),
  ('Banana', 90),
  ('Orange', 150);
      </code></pre>
      </div>
      <div class="note">ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ <code>001_</code> ãªã©é€£ç•ªã«ã™ã‚‹ã¨ã€è¤‡æ•°SQLã‚’é †åºå®Ÿè¡Œã§ãã¾ã™ã€‚</div>

      <h2 id="indexphp">11. <code>public/index.php</code>ï¼ˆCRUDã‚¢ãƒ—ãƒªï¼‰</h2>
      <p>å­¦ç¿’ã—ã‚„ã™ã„ã‚ˆã†ã€ä¸€è¦§ãƒ»è¿½åŠ ãƒ»ç·¨é›†ãƒ»å‰Šé™¤ã‚’1ãƒ•ã‚¡ã‚¤ãƒ«ã«åã‚ãŸæœ€å°å®Ÿè£…ã§ã™ï¼ˆPDOï¼‹ãƒ—ãƒªãƒšã‚¢ãƒ‰ã€ç°¡æ˜“CSRFã€ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ã€‚</p>
      <div class="code-block">
        <button type="button" class="copy-btn" title="ã‚³ãƒ”ãƒ¼">ğŸ“‹</button>
        <pre><code class="language-php">&lt;?php
declare(strict_types=1);
session_start();

$host = getenv('DB_HOST') ?: 'db';
$db   = getenv('DB_NAME') ?: 'myapp';
$user = getenv('DB_USER') ?: 'myuser';
$pass = getenv('DB_PASS') ?: 'mypassword';

function h(string $s): string { return htmlspecialchars($s, ENT_QUOTES, 'UTF-8'); }
function redirect(string $p): never { header("Location: {$p}"); exit; }
function flash(string $k, ?string $v=null) {
  if ($v === null) { $m = $_SESSION['flash'][$k] ?? null; unset($_SESSION['flash'][$k]); return $m; }
  $_SESSION['flash'][$k] = $v;
}
if (empty($_SESSION['csrf'])) { $_SESSION['csrf'] = bin2hex(random_bytes(16)); }
function csrf_field(): string { return '&lt;input type="hidden" name="csrf" value="'.h($_SESSION['csrf']).'"&gt;'; }
function assert_csrf(): void {
  if (!isset($_POST['csrf']) || !hash_equals($_SESSION['csrf'] ?? '', $_POST['csrf'])) {
    http_response_code(400); echo '&lt;h1&gt;Bad Request&lt;/h1&gt;&lt;p&gt;CSRF token mismatch.&lt;/p&gt;'; exit;
  }
}

try {
  $pdo = new PDO("mysql:host={$host};dbname={$db};charset=utf8mb4", $user, $pass, [
    PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION,
    PDO::ATTR_DEFAULT_FETCH_MODE =&gt; PDO::FETCH_ASSOC,
  ]);
} catch (Throwable $e) {
  http_response_code(500);
  echo "&lt;h1&gt;DBæ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ&lt;/h1&gt;&lt;pre&gt;".h($e-&gt;getMessage())."&lt;/pre&gt;"; exit;
}

$action = $_GET['action'] ?? 'index';

if ($action === 'store' &amp;&amp; $_SERVER['REQUEST_METHOD'] === 'POST') {
  assert_csrf();
  $name = trim($_POST['name'] ?? '');
  $price = trim($_POST['price'] ?? '');
  $errors = [];
  if ($name === '') $errors[] = 'åå‰ã¯å¿…é ˆã§ã™';
  if ($price === '' || !ctype_digit($price) || (int)$price &lt; 0) $errors[] = 'ä¾¡æ ¼ã¯0ä»¥ä¸Šã®æ•´æ•°ã§å…¥åŠ›ã—ã¦ãã ã•ã„';
  if ($errors) { flash('errors', implode('&lt;br&gt;', array_map('h', $errors))); flash('old', json_encode(['name'=>$name,'price'=>$price])); redirect('./?action=create'); }
  $stmt = $pdo-&gt;prepare('INSERT INTO items(name, price) VALUES(:name, :price)');
  $stmt-&gt;execute([':name'=>$name, ':price'=>(int)$price]);
  flash('success', 'ç™»éŒ²ã—ã¾ã—ãŸ'); redirect('./');

} elseif ($action === 'update' &amp;&amp; $_SERVER['REQUEST_METHOD'] === 'POST') {
  assert_csrf();
  $id = (int)($_GET['id'] ?? 0);
  $name = trim($_POST['name'] ?? '');
  $price = trim($_POST['price'] ?? '');
  $errors = [];
  if ($id &lt;= 0) $errors[] = 'ä¸æ­£ãªIDã§ã™';
  if ($name === '') $errors[] = 'åå‰ã¯å¿…é ˆã§ã™';
  if ($price === '' || !ctype_digit($price) || (int)$price &lt; 0) $errors[] = 'ä¾¡æ ¼ã¯0ä»¥ä¸Šã®æ•´æ•°ã§å…¥åŠ›ã—ã¦ãã ã•ã„';
  if ($errors) { flash('errors', implode('&lt;br&gt;', array_map('h', $errors))); redirect('./?action=edit&amp;id='.$id); }
  $stmt = $pdo-&gt;prepare('UPDATE items SET name=:name, price=:price WHERE id=:id');
  $stmt-&gt;execute([':name'=>$name, ':price'=>(int)$price, ':id'=>$id]);
  flash('success', 'æ›´æ–°ã—ã¾ã—ãŸ'); redirect('./');

} elseif ($action === 'destroy' &amp;&amp; $_SERVER['REQUEST_METHOD'] === 'POST') {
  assert_csrf();
  $id = (int)($_GET['id'] ?? 0);
  if ($id &gt; 0) { $stmt = $pdo-&gt;prepare('DELETE FROM items WHERE id=:id'); $stmt-&gt;execute([':id'=>$id]); }
  flash('success', 'å‰Šé™¤ã—ã¾ã—ãŸ'); redirect('./');

} else {
  $success = flash('success'); $errors = flash('errors'); $content = '';
  if ($action === 'create') {
    $old = json_decode(flash('old') ?? '{}', true);
    $content .= '&lt;h2&gt;å•†å“ã‚’è¿½åŠ &lt;/h2&gt;'.($errors ? '&lt;div class="alert alert-error"&gt;'.$errors.'&lt;/div&gt;':'' ).'
      &lt;form method="post" action="?action=store"&gt;'.csrf_field().'
        &lt;div class="field"&gt;&lt;label&gt;åå‰&lt;/label&gt;&lt;input type="text" name="name" value="'.h($old['name']??'').'" required&gt;&lt;/div&gt;
        &lt;div class="field"&gt;&lt;label&gt;ä¾¡æ ¼ï¼ˆæ•´æ•°ï¼‰&lt;/label&gt;&lt;input type="number" name="price" min="0" step="1" value="'.h($old['price']??'').'" required&gt;&lt;/div&gt;
        &lt;div class="actions"&gt;&lt;button type="submit"&gt;ç™»éŒ²ã™ã‚‹&lt;/button&gt; &lt;a class="btn" href="./"&gt;æˆ»ã‚‹&lt;/a&gt;&lt;/div&gt;
      &lt;/form&gt;';
  } elseif ($action === 'edit') {
    $id = (int)($_GET['id'] ?? 0);
    $stmt = $pdo-&gt;prepare('SELECT * FROM items WHERE id=:id'); $stmt-&gt;execute([':id'=>$id]); $item = $stmt-&gt;fetch();
    if (!$item) { http_response_code(404); echo '&lt;h1&gt;Not Found&lt;/h1&gt;'; exit; }
    $content .= '&lt;h2&gt;ID #'.(int)$item['id'].' ã‚’ç·¨é›†&lt;/h2&gt;'.($errors ? '&lt;div class="alert alert-error"&gt;'.$errors.'&lt;/div&gt;':'' ).'
      &lt;form method="post" action="?action=update&amp;id='.(int)$item['id'].'"&gt;'.csrf_field().'
        &lt;div class="field"&gt;&lt;label&gt;åå‰&lt;/label&gt;&lt;input type="text" name="name" value="'.h($item['name']).'" required&gt;&lt;/div&gt;
        &lt;div class="field"&gt;&lt;label&gt;ä¾¡æ ¼ï¼ˆæ•´æ•°ï¼‰&lt;/label&gt;&lt;input type="number" name="price" min="0" step="1" value="'.h((string)$item['price']).'" required&gt;&lt;/div&gt;
        &lt;div class="actions"&gt;&lt;button type="submit"&gt;æ›´æ–°ã™ã‚‹&lt;/button&gt; &lt;a class="btn" href="./"&gt;æˆ»ã‚‹&lt;/a&gt;&lt;/div&gt;
      &lt;/form&gt;';
  } else {
    $stmt = $pdo-&gt;query('SELECT id, name, price, created_at FROM items ORDER BY id DESC'); $rows = $stmt-&gt;fetchAll();
    $content .= '&lt;div class="toolbar"&gt;&lt;a class="btn primary" href="?action=create"&gt;ï¼‹ è¿½åŠ &lt;/a&gt;&lt;/div&gt;'
      .($success ? '&lt;div class="alert alert-ok"&gt;'.$success.'&lt;/div&gt;':'' ).'
      &lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;åå‰&lt;/th&gt;&lt;th&gt;ä¾¡æ ¼&lt;/th&gt;&lt;th&gt;ä½œæˆæ—¥æ™‚&lt;/th&gt;&lt;th&gt;æ“ä½œ&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;';
    foreach ($rows as $r) {
      $content .= '&lt;tr&gt;&lt;td&gt;'.(int)$r['id'].'&lt;/td&gt;&lt;td&gt;'.h($r['name']).'&lt;/td&gt;&lt;td&gt;'.(int)$r['price'].'&lt;/td&gt;&lt;td&gt;'.h((string)$r['created_at']).'&lt;/td&gt;
        &lt;td class="ops"&gt;&lt;a class="btn" href="?action=edit&amp;id='.(int)$r['id'].'"&gt;ç·¨é›†&lt;/a&gt;
        &lt;form method="post" action="?action=destroy&amp;id='.(int)$r['id'].'" onsubmit="return confirm(\'æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\');" style="display:inline"&gt;'.csrf_field().'&lt;button type="submit" class="btn danger"&gt;å‰Šé™¤&lt;/button&gt;&lt;/form&gt;&lt;/td&gt;&lt;/tr&gt;';
    }
    if (!$rows) { $content .= '&lt;tr&gt;&lt;td colspan="5" style="text-align:center; color:#777"&gt;ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“&lt;/td&gt;&lt;/tr&gt;'; }
    $content .= '&lt;/tbody&gt;&lt;/table&gt;';
  }

  echo '&lt;!doctype html&gt;&lt;html lang="ja"&gt;&lt;meta charset="utf-8"&gt;&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
  &lt;title&gt;Items CRUDï¼ˆPHP â†’ MySQLï¼‰&lt;/title&gt;
  &lt;style&gt;:root{--bg:#fff;--fg:#111;--muted:#666;--line:#e5e7eb;--pri:#2563eb}
  *{box-sizing:border-box} body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;margin:24px;color:var(--fg);background:var(--bg);line-height:1.6}
  h1{font-size:22px;margin:0 0 12px} h2{font-size:18px;margin:12px 0}
  table{border-collapse:collapse;width:100%;max-width:900px;margin-top:12px} th,td{border:1px solid var(--line);padding:10px} th{background:#f8fafc;text-align:left}
  .toolbar{margin:12px 0} .btn{display:inline-block;padding:.45em .8em;border:1px solid var(--line);border-radius:.5em;text-decoration:none;color:var(--fg);background:#f8fafc}
  .btn.primary{background:#2563eb;border-color:#2563eb;color:#fff} .btn.danger{background:#fee2e2;border-color:#fecaca;color:#b91c1c}
  .actions{margin-top:12px} .field{margin:8px 0;max-width:420px} input[type=text],input[type=number]{width:100%;padding:.5em;border:1px solid var(--line);border-radius:.4em}
  .alert{margin:10px 0;padding:.6em .8em;border-radius:.5em} .alert-ok{background:#e6ffed;border:1px solid #b7ebc6} .alert-error{background:#fee2e2;border:1px solid #fecaca}
  .ops form{display:inline} .meta{color:var(--muted);font-size:12px;margin-top:4px} .wrap{max-width:960px} header{display:flex;gap:8px;margin-bottom:10px;align-items:end}
  header .meta{margin-left:auto;color:#666;font-size:12px}&lt;/style&gt;
  &lt;div class="wrap"&gt;&lt;header&gt;&lt;h1&gt;Items CRUDï¼ˆPHP â†’ MySQLï¼‰&lt;/h1&gt;&lt;div class="meta"&gt;æ¥ç¶šå…ˆï¼š'.h("$host / $db / $user").'&lt;/div&gt;&lt;/header&gt;'.$content.'&lt;/div&gt;';
}
      </code></pre>
      </div>

      <h2 id="run">12. èµ·å‹•ãƒ»ç¢ºèªãƒ»åœæ­¢ã®æ‰‹é †</h2>
      <ol>
        <li>ä¸Šã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®</li>
        <li><kbd class="kbd">cd my-local-stack</kbd></li>
        <li><kbd class="kbd">docker compose build</kbd>ï¼ˆåˆå›ï¼Dockerfileå¤‰æ›´æ™‚ï¼‰</li>
        <li><kbd class="kbd">docker compose up -d</kbd>ï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰èµ·å‹•ï¼‰</li>
      </ol>
      <div class="grid two">
        <div class="good"><strong>Webã‚¢ãƒ—ãƒªï¼š</strong> <code>http://localhost:8080</code><br>ä¸€è¦§è¡¨ç¤º â†’ ã€Œï¼‹è¿½åŠ ã€â†’ ç·¨é›†ãƒ»å‰Šé™¤ã‚’ç¢ºèª</div>
        <div class="note"><strong>phpMyAdminï¼š</strong> <code>http://localhost:8081</code><br>ã‚µãƒ¼ãƒãƒ¼ï¼š<code>db</code><br>ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼š<code>myuser</code><br>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼š<code>mypassword</code><br>ï¼ˆ<code>.env</code>ã§è¨­å®šã—ãŸå€¤ã§æ‰‹å‹•ãƒ­ã‚°ã‚¤ãƒ³ï¼‰</div>
      </div>
      <p>åœæ­¢ï¼š<kbd class="kbd">docker compose down</kbd><br>DBåˆæœŸåŒ–ã‹ã‚‰ã‚„ã‚Šç›´ã™ï¼š<kbd class="kbd">docker compose down -v</kbd> â†’ <kbd class="kbd">up -d</kbd></p>

      <h2 id="trouble">13. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>
      <table>
        <thead><tr><th>ç—‡çŠ¶</th><th>ç¢ºèªãƒã‚¤ãƒ³ãƒˆ</th></tr></thead>
        <tbody>
          <tr>
            <td>Webã¯é–‹ããŒã€ŒDBæ¥ç¶šã«å¤±æ•—ã€</td>
            <td>
              <ul>
                <li><code>.env</code>ã®<code>MYSQL_*</code>ã¨<code>web</code>ã®<code>DB_*</code>ãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹</li>
                <li><kbd class="kbd">docker compose logs db</kbd> ã§MySQLèµ·å‹•å¤±æ•—ãŒãªã„ã‹</li>
                <li>ãƒãƒ¼ãƒˆ<code>3306</code>ãŒä»–ã®MySQLã§å æœ‰ã•ã‚Œã¦ã„ãªã„ã‹ï¼ˆå¿…è¦ãªã‚‰<code>DB_PORT</code>å¤‰æ›´ï¼‰</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td>phpMyAdminã§ã€Œã‚µãƒ¼ãƒãƒ¼ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã€</td>
            <td>
              <ul>
                <li><code>PMA_HOST: db</code> ã«ãªã£ã¦ã„ã‚‹ã‹ï¼ˆã‚µãƒ¼ãƒ“ã‚¹åã«åˆã‚ã›ã‚‹ï¼‰</li>
                <li><code>docker ps</code>ã§DBãŒ<em>healthy</em>ã‹</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td>åˆæœŸSQLãŒæµã‚Œã¦ã„ãªã„</td>
            <td>
              <ul>
                <li>SQLã¯<strong>åˆå›èµ·å‹•æ™‚ã®ã¿</strong>è‡ªå‹•å®Ÿè¡Œã€‚ã‚„ã‚Šç›´ã™ã¨ãã¯ <kbd class="kbd">down -v</kbd> â†’ <kbd class="kbd">up -d</kbd></li>
                <li>ãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­ãŒ<code>.sql</code>ã€é…ç½®ãŒ<code>db/init/</code>ã‹ã‚’ç¢ºèª</li>
              </ul>
            </td>
          </tr>
          <tr>
            <td>phpMyAdminã§ã€Œãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼</td>
            <td>
              <ul>
                <li><strong>åŸå› ï¼š</strong> Windowsç’°å¢ƒã§Dockerã‚’ä½¿ã†ã¨ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«(<code>config.inc.php</code>)ãŒã€Œèª°ã§ã‚‚æ›¸ãè¾¼ã¿å¯èƒ½ã€ã¨èª¤èªã•ã‚Œã‚‹ãŸã‚ã€‚</li>
                <li><strong>è§£æ±ºç­–Aï¼ˆæ¨å¥¨ï¼‰ï¼š</strong> <code>docker-compose.yml</code>ã®<code>phpmyadmin</code>ã‚µãƒ¼ãƒ“ã‚¹ã«<code>command</code>ã‚’è¿½åŠ ã—ã€èµ·å‹•æ™‚ã«ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’å¼·åˆ¶å¤‰æ›´ã™ã‚‹ã€‚ï¼ˆã“ã®ã‚¬ã‚¤ãƒ‰ã§æ¡ç”¨æ¸ˆã¿ã®æ–¹æ³•ï¼‰</li>
                <li><strong>è§£æ±ºç­–Bï¼ˆWindowsé™å®šï¼‰ï¼š</strong> <code>config.inc.php</code>ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ â†’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ â†’ è©³ç´°è¨­å®šã§ã€Œç¶™æ‰¿ã®ç„¡åŠ¹åŒ–ã€ã‚’è¡Œã†ã€‚</li>
                <li><strong>é‡è¦ï¼š</strong> å¯¾ç­–å¾Œã¯<code>docker compose down -v</code>ã§ç’°å¢ƒã‚’å®Œå…¨ã«ãƒªã‚»ãƒƒãƒˆã—ã¦ã‹ã‚‰å†èµ·å‹•ã™ã‚‹ã“ã¨ã€‚</li>
              </ul>
            </td>
          </tr>
        </tbody>
      </table>

      <h2 id="concepts">14. ç”¨èªé›†</h2>
      <table>
        <thead>
          <tr>
            <th style="width: 25%;">ç”¨èª</th>
            <th>èª¬æ˜</th>
          </tr>
        </thead>
        <tbody>
          <tr><td><strong>PDO (PHP Data Objects)</strong></td><td>PHPã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸æ¥ç¶šã™ã‚‹ãŸã‚ã®å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€‚ã“ã‚Œã‚’ä½¿ã†ã¨ã€MySQLã‹ã‚‰PostgreSQLãªã©ã¸DBã‚’å¤‰æ›´ã—ã¦ã‚‚ã€ã‚³ãƒ¼ãƒ‰ã®å¤§éƒ¨åˆ†ã‚’æ›¸ãæ›ãˆãšã«æ¸ˆã¿ã¾ã™ã€‚</td></tr>
          <tr><td><strong>ãƒ—ãƒªãƒšã‚¢ãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆ</strong></td><td>SQLæ–‡ã®ã€Œé››å½¢ã€ã‚’å…ˆã«DBã«é€ã‚Šã€å¾Œã‹ã‚‰å€¤ã‚’åŸ‹ã‚è¾¼ã‚€æ–¹å¼ã€‚SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒã‚’é˜²ããŸã‚ã®åŸºæœ¬çš„ãªå¯¾ç­–ã§ã™ã€‚</td></tr>
          <tr><td><strong>CSRFãƒˆãƒ¼ã‚¯ãƒ³</strong></td><td>æ‚ªæ„ã®ã‚ã‚‹å¤–éƒ¨ã‚µã‚¤ãƒˆã‹ã‚‰ã€æ„å›³ã—ãªã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆä¾‹: å‹æ‰‹ã«é€€ä¼šå‡¦ç†ï¼‰ã‚’é€ä¿¡ã•ã‚Œã‚‹ã®ã‚’é˜²ããŸã‚ã®ã€Œç§˜å¯†ã®åˆè¨€è‘‰ã€ã€‚ãƒ•ã‚©ãƒ¼ãƒ ã«åŸ‹ã‚è¾¼ã¿ã€ã‚µãƒ¼ãƒãƒ¼å´ã§æ¤œè¨¼ã—ã¾ã™ã€‚</td></tr>
          <tr><td><strong>ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</strong></td><td>ã€Œç™»éŒ²ã—ã¾ã—ãŸã€ãªã©ã®é€šçŸ¥ã‚’ã€ãƒšãƒ¼ã‚¸ã‚’ã¾ãŸã„ã§ã€Œ1å›ã ã‘ã€è¡¨ç¤ºã™ã‚‹ä»•çµ„ã¿ã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’åˆ©ç”¨ã—ã¦å®Ÿç¾ã—ã¾ã™ã€‚</td></tr>
        </tbody>
      </table>

      <h2 id="next">15. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>
      <ul>
        <li>ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰²ï¼š<code>create.php</code> / <code>edit.php</code> / <code>delete.php</code> ã¸åˆ†ã‘ã¦å¯èª­æ€§UP</li>
        <li>æ¤œç´¢ãƒ»ãƒšãƒ¼ã‚¸ãƒ³ã‚°ã€ã‚½ãƒ¼ãƒˆã®è¿½åŠ </li>
        <li>Xdebugã§ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆå­¦ç¿’ï¼ˆ<code>php.ini</code>ã¨VS Codeè¨­å®šï¼‰</li>
        <li>Nginx + PHP-FPM æ§‹æˆã¸ã®å¤‰æ›´ï¼ˆå®Ÿé‹ç”¨ã«è¿‘ã¥ã‘ã‚‹ï¼‰</li>
      </ul>

      <hr>
      <p class="small">Â© Your Local Notes â€” ã“ã®è³‡æ–™ã¯ãƒ­ãƒ¼ã‚«ãƒ«å­¦ç¿’ç”¨ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ç§˜åŒ¿æƒ…å ±ã®ã‚³ãƒŸãƒƒãƒˆã¯é¿ã‘ã¾ã—ã‚‡ã†ã€‚</p>
    </main>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const layout = document.querySelector('.layout');
      const sidebar = document.getElementById('sidebar');
      const toggleBtn = document.querySelector('.sidebar-toggle');
      const toggleIcon = toggleBtn.querySelector('.sidebar-toggle-icon');

      function updateToggleState() {
        let isExpanded;
        if (window.innerWidth > 900) {
          isExpanded = !layout.classList.contains('sidebar-collapsed');
          toggleIcon.textContent = isExpanded ? 'Â«' : 'â˜°';
        } else {
          isExpanded = sidebar.classList.contains('open');
          toggleIcon.textContent = isExpanded ? 'âœ•' : 'â˜°';
        }
        toggleBtn.setAttribute('aria-expanded', String(isExpanded));
      }

      toggleBtn.addEventListener('click', () => {
        if (window.innerWidth > 900) {
          layout.classList.toggle('sidebar-collapsed');
        } else {
          sidebar.classList.toggle('open');
        }
        updateToggleState();
      });

      // --- Scroll Spy ---
      const sections = document.querySelectorAll('main h2[id]');
      const tocLinks = document.querySelectorAll('.toc a');

      const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const id = entry.target.getAttribute('id');
            tocLinks.forEach(link => {
              link.classList.toggle('active', link.getAttribute('href') === `#${id}`);
            });
          }
        });
      }, { rootMargin: "-50% 0px -50% 0px" });

      sections.forEach(section => observer.observe(section));

      // --- Smooth Scroll & Close Sidebar on Mobile ---
      tocLinks.forEach(link => {
        link.addEventListener('click', e => {
          e.preventDefault();
          const targetId = link.getAttribute('href');
          document.querySelector(targetId).scrollIntoView({ behavior: 'smooth' });

          if (window.innerWidth <= 900 && sidebar.classList.contains('open')) {
            sidebar.classList.remove('open');
            updateToggleState();
          }
        });
      });

      // --- Copy Button Logic ---
      document.addEventListener('click', e => {
        const copyBtn = e.target.closest('.copy-btn');
        if (!copyBtn) return;

        const block = copyBtn.closest('.code-block');
        const pre = block?.querySelector('pre');
        if (pre) {
          navigator.clipboard.writeText(pre.textContent).then(() => {
            const originalText = copyBtn.textContent;
            copyBtn.textContent = 'âœ” Copied';
            copyBtn.classList.add('copied');
            setTimeout(() => {
              copyBtn.textContent = originalText;
              copyBtn.classList.remove('copied');
            }, 1500);
          }).catch(err => { console.error('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ', err); alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚'); });
        }
      });

      // --- Theme Toggle Logic ---
      const themeSwitch = document.getElementById('themeSwitch');
      function applyTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
      }
      function initTheme() {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          applyTheme(savedTheme);
          themeSwitch.checked = (savedTheme === 'dark');
        } else {
          const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          const osTheme = prefersDark ? 'dark' : 'light';
          applyTheme(osTheme);
          themeSwitch.checked = prefersDark;
        }
      }
      themeSwitch.addEventListener('change', () => {
        const theme = themeSwitch.checked ? 'dark' : 'light';
        applyTheme(theme);
        localStorage.setItem('theme', theme);
      });

      // --- Init ---
      updateToggleState();
      window.addEventListener('resize', updateToggleState);
      if (window.hljs) {
        window.hljs.highlightAll();
      }
      mermaid.initialize({ startOnLoad: true, theme: 'base' });
      initTheme();
    });
  </script>
</body>
</html>
